package search;

import java.util.Random;
import java.util.concurrent.ForkJoinPool;

public class Driver {

	private static void shuffleArray(Integer[] array){
	    int index, temp;
	    Random random = new Random();
	    for (int i = array.length - 1; i > 0; i--)
	    {
	        index = random.nextInt(i + 1);
	        temp = array[index];
	        array[index] = array[i];
	        array[i] = temp;
	    }
	}
	
	
	public static void main(String[] args) {
		int N = 100;
		Integer[] buffer = new Integer[N];
		for(int i = 0; i < N; i++) {
			buffer[i] = i + 1;
		}
		shuffleArray(buffer);
		int target = 59;
		
		// used to speed up one big task, and divide and conquer as small tasks
		ForkJoinPool forkJoinPool = new ForkJoinPool(10);
		// give a new task
		forkJoinPool.invoke(new Searcher(buffer,0, buffer.length, target));
	}

}

----------------------------------------------------------------------
package search;

import java.util.concurrent.RecursiveAction;

public class Searcher extends RecursiveAction{
	
	private static final long serialVersionUID = 1L;
	private Integer[] buffer; 
	private int start;
	private int end;
	private int target;
	
	public Searcher(Integer[] buffer, int s, int e, int f) {
		this.buffer = buffer;
		this.start = s;
		this.end = e;
		this.target = f;
	}
	
	@Override
	protected void compute() {
		if(end - start <= 25) {    // Threshold set to 25
			//synchronized(this) {
				StringBuffer bf = new StringBuffer();
				bf.append(Thread.currentThread().getName());
				bf.append("\n");
				for(int i = start; i < end; i++) {
					bf.append(buffer[i]+",");
					if(buffer[i] == target) bf.append("---found---");
					
				}
				System.out.println(bf.toString());
			//}
		}else {
			int mid = (start + end) /2;
		    Searcher left = new Searcher(buffer, start, mid,target);
		    Searcher right = new Searcher(buffer, mid, end,target);
		    left.fork();
		    //right.fork();
            right.compute();
            left.join();
            //right.join();
		}
	}
	

}
